<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Code Auditor | Autonomous Security Pipeline</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .glass-panel { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); }
        .step-check { transition: all 0.3s ease; }
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body class="text-slate-800 h-screen flex flex-col overflow-hidden">

    <nav class="bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center z-10">
        <div class="flex items-center gap-3">
            <div class="bg-blue-600 text-white p-2 rounded-lg">
                <i class="fa-solid fa-shield-halved text-xl"></i>
            </div>
            <span class="text-xl font-bold tracking-tight text-slate-900">AI Code<span class="text-blue-600">Auditor</span></span>
        </div>
        <div class="text-sm text-slate-500">
            <span class="mr-4"><i class="fa-solid fa-circle text-green-500 text-[10px] mr-2"></i>System Operational</span>
            <a href="#" class="hover:text-blue-600 transition">Docs</a>
        </div>
    </nav>

    <main class="flex-1 relative overflow-y-auto">

        <section id="view-input" class="absolute inset-0 flex flex-col items-center justify-center p-4 transition-opacity duration-500">
            <div class="text-center mb-10 max-w-2xl">
                <h1 class="text-4xl md:text-5xl font-extrabold text-slate-900 mb-4">Autonomous Code Security</h1>
                <p class="text-lg text-slate-500">Deploy a 6-agent AI pipeline to audit your codebase for security flaws, architectural bugs, and performance issues in seconds.</p>
            </div>

            <div class="bg-white rounded-2xl shadow-xl border border-slate-100 p-2 w-full max-w-lg">
                <div class="flex bg-slate-100 rounded-xl p-1 mb-6">
                    <button onclick="switchTab('zip')" id="tab-zip" class="flex-1 py-2 px-4 rounded-lg text-sm font-semibold bg-white text-blue-600 shadow-sm transition-all">
                        <i class="fa-solid fa-file-zipper mr-2"></i> Upload Zip
                    </button>
                    <button onclick="switchTab('git')" id="tab-git" class="flex-1 py-2 px-4 rounded-lg text-sm font-semibold text-slate-500 hover:text-slate-700 transition-all">
                        <i class="fa-brands fa-github mr-2"></i> Git Repo
                    </button>
                </div>

                <div id="input-zip" class="p-6 pt-0 text-center border-2 border-dashed border-slate-200 rounded-xl hover:border-blue-400 hover:bg-blue-50 transition-colors cursor-pointer group">
                    <div class="py-8" onclick="triggerScan()">
                        <i class="fa-solid fa-cloud-arrow-up text-4xl text-slate-300 group-hover:text-blue-500 mb-4 transition-colors"></i>
                        <p class="font-medium text-slate-700">Click to upload project zip</p>
                        <p class="text-xs text-slate-400 mt-1">Max size 50MB</p>
                    </div>
                </div>

                <div id="input-git" class="p-6 pt-0 hidden">
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-2">Repository URL</label>
                    <div class="flex gap-2">
                        <input type="text" placeholder="https://github.com/username/repo" class="flex-1 bg-slate-50 border border-slate-200 rounded-lg px-4 py-3 outline-none focus:ring-2 focus:ring-blue-500 transition-all">
                        <button onclick="triggerScan()" class="bg-slate-900 hover:bg-black text-white px-6 rounded-lg font-bold transition-transform active:scale-95">
                            Scan
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="mt-8 flex gap-8 text-slate-400 text-2xl">
                <i class="fa-brands fa-python hover:text-slate-600 transition"></i>
                <i class="fa-brands fa-js hover:text-slate-600 transition"></i>
                <i class="fa-brands fa-java hover:text-slate-600 transition"></i>
                <i class="fa-brands fa-rust hover:text-slate-600 transition"></i>
            </div>
        </section>


        <section id="view-loading" class="hidden absolute inset-0 flex flex-col items-center justify-center p-4 bg-white z-20">
            <div class="w-full max-w-md">
                <div class="text-center mb-8">
                    <div class="inline-block p-4 rounded-full bg-blue-50 mb-4">
                        <i class="fa-solid fa-circle-nodes text-4xl text-blue-600 animate-pulse"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-slate-900">Running Multi-Agent Pipeline</h2>
                    <p class="text-slate-500 text-sm">Orchestrating 6 autonomous agents...</p>
                </div>

                <div class="space-y-3">
                    <div class="agent-step flex items-center justify-between p-3 rounded-lg border border-slate-100 bg-slate-50" id="step-1">
                        <div class="flex items-center gap-3">
                            <i class="fa-solid fa-folder-open text-slate-400 w-5"></i>
                            <span class="text-sm font-medium text-slate-600">Repo Reader Agent</span>
                        </div>
                        <i class="fa-solid fa-circle-notch fa-spin text-blue-500 status-icon"></i>
                    </div>

                    <div class="agent-step flex items-center justify-between p-3 rounded-lg border border-slate-100 opacity-50" id="step-2">
                        <div class="flex items-center gap-3">
                            <i class="fa-solid fa-magnifying-glass-chart text-slate-400 w-5"></i>
                            <span class="text-sm font-medium text-slate-600">Static Analyzer</span>
                        </div>
                        <i class="fa-regular fa-circle text-slate-300 status-icon"></i>
                    </div>

                    <div class="agent-step flex items-center justify-between p-3 rounded-lg border border-slate-100 opacity-50" id="step-3">
                        <div class="flex items-center gap-3">
                            <i class="fa-solid fa-brain text-slate-400 w-5"></i>
                            <span class="text-sm font-medium text-slate-600">LLM Architect Review</span>
                        </div>
                        <i class="fa-regular fa-circle text-slate-300 status-icon"></i>
                    </div>

                    <div class="agent-step flex items-center justify-between p-3 rounded-lg border border-slate-100 opacity-50" id="step-4">
                        <div class="flex items-center gap-3">
                            <i class="fa-solid fa-filter text-slate-400 w-5"></i>
                            <span class="text-sm font-medium text-slate-600">Issue Categorizer</span>
                        </div>
                        <i class="fa-regular fa-circle text-slate-300 status-icon"></i>
                    </div>

                    <div class="agent-step flex items-center justify-between p-3 rounded-lg border border-slate-100 opacity-50" id="step-5">
                        <div class="flex items-center gap-3">
                            <i class="fa-solid fa-arrow-down-wide-short text-slate-400 w-5"></i>
                            <span class="text-sm font-medium text-slate-600">Priority Ranking</span>
                        </div>
                        <i class="fa-regular fa-circle text-slate-300 status-icon"></i>
                    </div>
                </div>
            </div>
        </section>


        <section id="view-dashboard" class="hidden absolute inset-0 overflow-y-auto bg-slate-50 p-6 md:p-10 fade-in">
            <div class="max-w-7xl mx-auto">
                
                <div class="flex flex-col md:flex-row justify-between items-end mb-8 border-b border-slate-200 pb-6">
                    <div>
                        <div class="flex items-center gap-3 mb-2">
                            <h1 class="text-3xl font-bold text-slate-900">Audit Report</h1>
                            <span class="bg-blue-100 text-blue-700 text-xs font-bold px-2 py-1 rounded uppercase">Ready</span>
                        </div>
                        <p class="text-slate-500">Project: <span class="font-mono text-slate-700 font-semibold">payment-gateway-v2</span> â€¢ Branch: <span class="font-mono">main</span></p>
                    </div>
                    <div class="flex gap-3">
                        <button class="bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 px-4 py-2 rounded-lg text-sm font-semibold shadow-sm transition">
                            <i class="fa-solid fa-download mr-2"></i> PDF
                        </button>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-semibold shadow-sm transition" onclick="location.reload()">
                            <i class="fa-solid fa-rotate-right mr-2"></i> New Scan
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 md:col-span-1 flex flex-col justify-between">
                        <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Quality Score</p>
                        <div class="mt-4 flex items-end gap-2">
                            <span class="text-5xl font-black text-slate-900">4.2</span>
                            <span class="text-xl text-slate-400 font-medium mb-1">/ 10</span>
                        </div>
                        <div class="w-full bg-slate-100 rounded-full h-2 mt-4 overflow-hidden">
                            <div class="bg-red-500 h-2 rounded-full" style="width: 42%"></div>
                        </div>
                        <p class="text-xs text-red-500 mt-2 font-medium"><i class="fa-solid fa-triangle-exclamation mr-1"></i> Critical vulnerabilities found</p>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 md:col-span-3 grid grid-cols-3 gap-4">
                        <div class="text-center p-4 bg-red-50 rounded-lg border border-red-100">
                            <div class="text-red-600 text-3xl font-bold mb-1">2</div>
                            <div class="text-xs font-bold text-red-400 uppercase">Critical</div>
                        </div>
                        <div class="text-center p-4 bg-orange-50 rounded-lg border border-orange-100">
                            <div class="text-orange-600 text-3xl font-bold mb-1">5</div>
                            <div class="text-xs font-bold text-orange-400 uppercase">High</div>
                        </div>
                        <div class="text-center p-4 bg-blue-50 rounded-lg border border-blue-100">
                            <div class="text-blue-600 text-3xl font-bold mb-1">12</div>
                            <div class="text-xs font-bold text-blue-400 uppercase">Low/Info</div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    
                    <div class="lg:col-span-2">
                        <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                            <div class="p-5 border-b border-slate-100 bg-slate-50 flex justify-between items-center">
                                <h3 class="font-bold text-slate-800">Prioritized Issues</h3>
                                <div class="flex gap-2 text-xs">
                                    <span class="px-2 py-1 bg-white border border-slate-200 rounded cursor-pointer hover:border-blue-500">All</span>
                                    <span class="px-2 py-1 bg-white border border-slate-200 rounded cursor-pointer hover:border-blue-500">Security</span>
                                </div>
                            </div>
                            
                            <div class="divide-y divide-slate-100">
                                <div class="p-5 hover:bg-slate-50 transition group cursor-pointer">
                                    <div class="flex justify-between items-start mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="bg-red-100 text-red-700 text-[10px] font-bold px-2 py-0.5 rounded uppercase border border-red-200">Critical</span>
                                            <span class="text-xs font-mono text-slate-400">SQL-INJ-001</span>
                                        </div>
                                        <span class="text-xs font-bold text-slate-300 group-hover:text-blue-500 transition">View Fix <i class="fa-solid fa-arrow-right ml-1"></i></span>
                                    </div>
                                    <h4 class="font-bold text-slate-800 text-sm mb-1">Potential SQL Injection in User Service</h4>
                                    <p class="text-sm text-slate-500 mb-3 line-clamp-2">Raw SQL query constructed using f-strings detected in `get_user_by_id`. This allows attackers to manipulate database queries.</p>
                                    <div class="flex items-center gap-4 text-xs text-slate-400 font-mono">
                                        <span><i class="fa-regular fa-file mr-1"></i> services/user.py</span>
                                        <span><i class="fa-solid fa-list-ol mr-1"></i> Line 42</span>
                                    </div>
                                </div>

                                <div class="p-5 hover:bg-slate-50 transition group cursor-pointer">
                                    <div class="flex justify-between items-start mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="bg-red-100 text-red-700 text-[10px] font-bold px-2 py-0.5 rounded uppercase border border-red-200">Critical</span>
                                            <span class="text-xs font-mono text-slate-400">SEC-CFG-002</span>
                                        </div>
                                    </div>
                                    <h4 class="font-bold text-slate-800 text-sm mb-1">Debug Mode Enabled in Production</h4>
                                    <p class="text-sm text-slate-500 mb-3">Flask application initialized with `debug=True`. This exposes the interactive debugger and sensitive environment details.</p>
                                    <div class="flex items-center gap-4 text-xs text-slate-400 font-mono">
                                        <span><i class="fa-regular fa-file mr-1"></i> app.py</span>
                                        <span><i class="fa-solid fa-list-ol mr-1"></i> Line 8</span>
                                    </div>
                                </div>

                                <div class="p-5 hover:bg-slate-50 transition group cursor-pointer">
                                    <div class="flex justify-between items-start mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="bg-orange-100 text-orange-700 text-[10px] font-bold px-2 py-0.5 rounded uppercase border border-orange-200">High</span>
                                            <span class="text-xs font-mono text-slate-400">AUTH-003</span>
                                        </div>
                                    </div>
                                    <h4 class="font-bold text-slate-800 text-sm mb-1">Weak Password Hashing Algorithm</h4>
                                    <p class="text-sm text-slate-500 mb-3">MD5 is used for password hashing. It is cryptographically broken and susceptible to collision attacks.</p>
                                    <div class="flex items-center gap-4 text-xs text-slate-400 font-mono">
                                        <span><i class="fa-regular fa-file mr-1"></i> utils/auth.py</span>
                                        <span><i class="fa-solid fa-list-ol mr-1"></i> Line 115</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div class="bg-gradient-to-br from-slate-900 to-slate-800 rounded-xl shadow-lg p-6 text-white">
                            <h3 class="font-bold text-lg mb-4 flex items-center gap-2"><i class="fa-solid fa-robot text-blue-400"></i> AI Insights</h3>
                            <ul class="space-y-4">
                                <li class="flex gap-3 text-sm text-slate-300">
                                    <i class="fa-solid fa-check mt-1 text-green-400"></i>
                                    <span>Switch to an ORM (like SQLAlchemy) to eliminate SQL injection risks entirely.</span>
                                </li>
                                <li class="flex gap-3 text-sm text-slate-300">
                                    <i class="fa-solid fa-check mt-1 text-green-400"></i>
                                    <span>Implement environment variables for configuration instead of hardcoding flags.</span>
                                </li>
                                <li class="flex gap-3 text-sm text-slate-300">
                                    <i class="fa-solid fa-check mt-1 text-green-400"></i>
                                    <span>Add a `requirements.txt` to ensure reproducible builds.</span>
                                </li>
                            </ul>
                        </div>

                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                            <h4 class="font-bold text-slate-800 text-sm mb-4">Issues by Category</h4>
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>

                </div>
            </div>
        </section>

    </main>

    <script>
        // Tab Switching Logic
        function switchTab(type) {
            const zipBtn = document.getElementById('tab-zip');
            const gitBtn = document.getElementById('tab-git');
            const zipInput = document.getElementById('input-zip');
            const gitInput = document.getElementById('input-git');

            if (type === 'zip') {
                zipBtn.className = "flex-1 py-2 px-4 rounded-lg text-sm font-semibold bg-white text-blue-600 shadow-sm transition-all";
                gitBtn.className = "flex-1 py-2 px-4 rounded-lg text-sm font-semibold text-slate-500 hover:text-slate-700 transition-all";
                zipInput.classList.remove('hidden');
                gitInput.classList.add('hidden');
            } else {
                gitBtn.className = "flex-1 py-2 px-4 rounded-lg text-sm font-semibold bg-white text-blue-600 shadow-sm transition-all";
                zipBtn.className = "flex-1 py-2 px-4 rounded-lg text-sm font-semibold text-slate-500 hover:text-slate-700 transition-all";
                gitInput.classList.remove('hidden');
                zipInput.classList.add('hidden');
            }
        }

        // Processing Simulation Logic
        function triggerScan() {
            // Hide Input, Show Loading
            document.getElementById('view-input').classList.add('hidden');
            document.getElementById('view-loading').classList.remove('hidden');
            document.getElementById('view-loading').classList.add('flex');

            // Simulate Agents (Timeouts)
            const steps = [1, 2, 3, 4, 5];
            let delay = 500;

            steps.forEach(step => {
                setTimeout(() => {
                    const el = document.getElementById(`step-${step}`);
                    const icon = el.querySelector('.status-icon');
                    
                    // Activate current step
                    el.classList.remove('opacity-50');
                    el.classList.add('bg-blue-50', 'border-blue-100');
                    icon.className = "fa-solid fa-circle-notch fa-spin text-blue-500 status-icon";

                    // Complete previous step (if exists)
                    if(step > 1) {
                        const prev = document.getElementById(`step-${step-1}`);
                        const prevIcon = prev.querySelector('.status-icon');
                        prev.classList.remove('bg-blue-50', 'border-blue-100');
                        prev.classList.add('bg-green-50', 'border-green-100');
                        prevIcon.className = "fa-solid fa-circle-check text-green-500 status-icon";
                    }

                }, delay);
                delay += 800; // Time between steps
            });

            // Finish Loading
            setTimeout(() => {
                document.getElementById('view-loading').classList.add('hidden');
                document.getElementById('view-loading').classList.remove('flex');
                document.getElementById('view-dashboard').classList.remove('hidden');
                
                // Init Chart
                initChart();
            }, delay + 800);
        }

        // Chart.js Init
        function initChart() {
            const ctx = document.getElementById('categoryChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Security', 'Bug', 'Style', 'Perf'],
                    datasets: [{
                        data: [40, 25, 20, 15],
                        backgroundColor: ['#ef4444', '#f97316', '#3b82f6', '#10b981'],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    cutout: '75%',
                    plugins: {
                        legend: { position: 'bottom', labels: { usePointStyle: true, boxWidth: 8 } }
                    }
                }
            });
        }
    </script>
</body>
</html>